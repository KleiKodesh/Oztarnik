<UserControl x:Class="Oztarnik.Main.OtzarnikView"
             xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
             xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
             xmlns:mc="http://schemas.openxmlformats.org/markup-compatibility/2006" 
             xmlns:d="http://schemas.microsoft.com/expression/blend/2008" 
             xmlns:local="clr-namespace:Oztarnik.Main"
             xmlns:ap="clr-namespace:WpfLib.AttachedProperties;assembly=WpfLib"
             xmlns:fs="clr-namespace:Otzarnik.FsViewer"
             mc:Ignorable="d" 
             FlowDirection="RightToLeft"
             d:DesignHeight="450" d:DesignWidth="350"
             FontSize="13">

    <UserControl.Resources>
    <ResourceDictionary>
        <ResourceDictionary.MergedDictionaries>
            <ResourceDictionary Source="/Oztarnik;component/FsViewer/FsDictionary.xaml"/>
            <ResourceDictionary Source="/WpfLib;component/Dictionaries/BaseDictionary.xaml"/>
        </ResourceDictionary.MergedDictionaries>
    </ResourceDictionary>
</UserControl.Resources>

    <Grid ap:GridSetup.Rows="* auto">
        <TabControl x:Name="MainTabControl"
        Padding="0" Margin="0" BorderThickness="0">
            <TabControl.Resources>
                <Style TargetType="TabItem">
                    <Setter Property="Visibility" Value="Collapsed"/>
                </Style>
            </TabControl.Resources>

            <TabItem x:Name="FsTab" FocusManager.FocusedElement="{Binding ElementName=FsSearchBox}"
                 PreviewKeyDown="FsTab_PreviewKeyDown">
                <Grid ap:GridSetup.Rows="auto *">

                    <Grid ap:GridSetup.Columns="* auto"
                        Margin="3">
                        <UniformGrid Grid.Column="1" Rows="1">
                            <Button Style="{StaticResource FlatButton}"
                                 Command="{Binding GoBackCommand, ElementName=fsViewer}">
                                <Path Data="M15,20H9V12H4.16L12,4.16L19.84,12H15V20Z"/>
                            </Button>
                            <Button Style="{StaticResource FlatButton}"
                                Command="{Binding ResetCommand, ElementName=fsViewer}">
                                <Path Data="M10,20V14H14V20H19V12H22L12,3L2,12H5V20H10Z"/>
                            </Button>
                        </UniformGrid>
                        <TextBox x:Name="FsSearchBox"
                        Style="{StaticResource WaterMarkTextBox}"
                        ToolTip="חיפוש..."
                        Text="{Binding SearchString, ElementName=fsViewer, UpdateSourceTrigger=PropertyChanged, Mode=TwoWay}"
                        AcceptsReturn="False">
                            <TextBox.InputBindings>
                                <KeyBinding Key="Return" Command="{Binding SearchCommand, ElementName=fsViewer}"/>
                            </TextBox.InputBindings>
                        </TextBox>
                    </Grid>

                    <fs:FsListView x:Name="fsViewer" Grid.Row="1" Grid.ColumnSpan="2" FocusVisualStyle="{x:Null}"
                              NavigationRequested="fsViewer_NavigationRequested"/>
                </Grid>
            </TabItem>

            <TabItem x:Name="FileViewerTab">
                <TabControl x:Name="FileViewerTabControl"
                            SelectionChanged="FileViewerTabControl_SelectionChanged"
                            Margin="0"
                            BorderThickness="0">
                    <TabControl.Resources>
                        <Style TargetType="TabItem" BasedOn="{StaticResource X_ButtonTabStyle}">
                            <Setter Property="Padding" Value="0"/>
                        </Style>
                    </TabControl.Resources>
                </TabControl>
            </TabItem>

            <TabItem Name="SettingsTab">
                <Button x:Name="FolderPickerButton"
                        Click="FolderPickerButton_Click"/>
            </TabItem>

        </TabControl>

        <StackPanel  Grid.Row="1"
                     Orientation="Horizontal"
                     HorizontalAlignment="Center">
            <ToggleButton x:Name="FsToggleButton"
                          Style="{StaticResource FlatToggleButton}"
                          IsChecked="{Binding IsSelected, ElementName=FsTab}">
                <Path Data="M9 3V18H12V3H9M12 5L16 18L19 17L15 4L12 5M5 5V18H8V5H5M3 19V21H21V19H3Z"/>
            </ToggleButton>
            <ToggleButton x:Name="FileViewToggleButton"
                          Style="{StaticResource FlatToggleButton}"
                          IsChecked="{Binding IsSelected, ElementName=FileViewerTab}">
                <Path Data="M17.5 14.33C18.29 14.33 19.13 14.41 20 14.57V16.07C19.38 15.91 18.54 15.83 17.5 15.83C15.6 15.83 14.11 16.16 13 16.82V15.13C14.17 14.6 15.67 14.33 17.5 14.33M13 12.46C14.29 11.93 15.79 11.67 17.5 11.67C18.29 11.67 19.13 11.74 20 11.9V13.4C19.38 13.24 18.54 13.16 17.5 13.16C15.6 13.16 14.11 13.5 13 14.15M17.5 10.5C15.6 10.5 14.11 10.82 13 11.5V9.84C14.23 9.28 15.73 9 17.5 9C18.29 9 19.13 9.08 20 9.23V10.78C19.26 10.59 18.41 10.5 17.5 10.5M21 18.5V7C19.96 6.67 18.79 6.5 17.5 6.5C15.45 6.5 13.62 7 12 8V19.5C13.62 18.5 15.45 18 17.5 18C18.69 18 19.86 18.16 21 18.5M17.5 4.5C19.85 4.5 21.69 5 23 6V20.56C23 20.68 22.95 20.8 22.84 20.91C22.73 21 22.61 21.08 22.5 21.08C22.39 21.08 22.31 21.06 22.25 21.03C20.97 20.34 19.38 20 17.5 20C15.45 20 13.62 20.5 12 21.5C10.66 20.5 8.83 20 6.5 20C4.84 20 3.25 20.36 1.75 21.07C1.72 21.08 1.68 21.08 1.63 21.1C1.59 21.11 1.55 21.12 1.5 21.12C1.39 21.12 1.27 21.08 1.16 21C1.05 20.89 1 20.78 1 20.65V6C2.34 5 4.18 4.5 6.5 4.5C8.83 4.5 10.66 5 12 6C13.34 5 15.17 4.5 17.5 4.5Z"/>
            </ToggleButton>
            <ToggleButton x:Name="SettingsToggleButton"
              Style="{StaticResource FlatToggleButton}"
              IsChecked="{Binding IsSelected, ElementName=SettingsTab}">
                <Path Data="M12,15.5A3.5,3.5 0 0,1 8.5,12A3.5,3.5 0 0,1 12,8.5A3.5,3.5 0 0,1 15.5,12A3.5,3.5 0 0,1 12,15.5M19.43,12.97C19.47,12.65 19.5,12.33 19.5,12C19.5,11.67 19.47,11.34 19.43,11L21.54,9.37C21.73,9.22 21.78,8.95 21.66,8.73L19.66,5.27C19.54,5.05 19.27,4.96 19.05,5.05L16.56,6.05C16.04,5.66 15.5,5.32 14.87,5.07L14.5,2.42C14.46,2.18 14.25,2 14,2H10C9.75,2 9.54,2.18 9.5,2.42L9.13,5.07C8.5,5.32 7.96,5.66 7.44,6.05L4.95,5.05C4.73,4.96 4.46,5.05 4.34,5.27L2.34,8.73C2.21,8.95 2.27,9.22 2.46,9.37L4.57,11C4.53,11.34 4.5,11.67 4.5,12C4.5,12.33 4.53,12.65 4.57,12.97L2.46,14.63C2.27,14.78 2.21,15.05 2.34,15.27L4.34,18.73C4.46,18.95 4.73,19.03 4.95,18.95L7.44,17.94C7.96,18.34 8.5,18.68 9.13,18.93L9.5,21.58C9.54,21.82 9.75,22 10,22H14C14.25,22 14.46,21.82 14.5,21.58L14.87,18.93C15.5,18.67 16.04,18.34 16.56,17.94L19.05,18.95C19.27,19.03 19.54,18.95 19.66,18.73L21.66,15.27C21.78,15.05 21.73,14.78 21.54,14.63L19.43,12.97Z"/>
            </ToggleButton>
        </StackPanel>
    </Grid>
</UserControl>
